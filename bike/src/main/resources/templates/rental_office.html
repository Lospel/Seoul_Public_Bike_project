<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<th:block th:replace="/layout/fragments/head :: headFragment(title='Rental Office')"></th:block>
<!-- 사이드바 -->
<th:block th:replace="/layout/fragments/sidebar :: sidebarFragment(current='Rental Office')"></th:block>

<th:block layout:fragment="content" class="container my-3">
  
    <form th:action="@{/rental/rental_office}" method="GET">
      <!-- 상단 검색창 -->
      <div class="container-fluid d-grid gap-3 align-items-center" style="grid-template-columns: 1fr 2fr; ">

        <div class="d-flex align-items-center" >
          <form class="w-100 me-3" role="search">
            <input type="text" id="keyword" name="keyword" th:value="${keyword}" class="form-control" placeholder="Rental_Office Search" aria-label="Search">
          </form>
          <button class="btn btn-outline-secondary btn-dark" type="submit" id="btn_search">Find</button>
        </div>
      </div>
      <div id="map" style="width:100%; height:800px;"></div>

    </form>
    <th:block th:replace="/layout/fragments/script :: scriptFragment"></th:block>
</th:block>
<script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=75ojy30gbk "></script>

<script  th:inline="javascript">
	
  $(function() {
    
    initMap();
    
  });
  
  
  function initMap() { 

    
    let markers = new Array(); // 마커 정보를 담는 배열
    let infoWindows = new Array(); // 정보창을 담는 배열
    
     /*<![CDATA[*/
     var list = '[[${place}]]';
     var list1 = list.replaceAll("[", "");
     var list2 = list1.replaceAll("]", "");
     var list3 = list2.replaceAll('"',"");
     var list4 = list3.replaceAll(':', ",");
     var list5 = list4.replaceAll("{", "");
     var list6 = list5.replaceAll("}", "");
     var list7 = list6.split(',');
       console.log(list7);
    
	  /*]]>*/

    var position = new naver.maps.LatLng(list7[5], list7[9]);

    var map = new naver.maps.Map('map', {
      center: position,
      zoom: 17
    });

    var markerOptions = {
      position: position.destinationPoint(0, 20),
      map: map,
      icon: {
        url: 'https://navermaps.github.io/maps.js.ncp/docs/img/example/sally.png',
        size: new naver.maps.Size(50, 52),
        origin: new naver.maps.Point(0, 0),
        anchor: new naver.maps.Point(25, 26)
      }
    };

    var marker = new naver.maps.Marker(markerOptions);
    
    /*<![CDATA[*/
    /*[# th:each="tmp : ${offices}"]*/
	  noti(/*[[${tmp.placename}]]*/, /*[[${tmp.latitude}]]*/, /*[[${tmp.longitude}]]*/); //여기 Argument expression expected. 에러 무시해도 됩니다.
	  /*[/]*/
	  /*]]>*/

    function noti(numValue, latValue, lngValue){
      var marker = new naver.maps.Marker({
              map: map,
              title: numValue, // 지역구 이름 
              position: new naver.maps.LatLng(latValue , lngValue) // 지역구의 위도 경도 넣기 
          });

      naver.maps.Event.addListener(marker, 'click', function(e){
      map.panTo(e.coord);
      });
    }

  }

  
	
</script>

</html>